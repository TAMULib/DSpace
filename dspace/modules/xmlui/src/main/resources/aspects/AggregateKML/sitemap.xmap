<?xml version="1.0"?>
<!--
  sitemap.xmap
-->

<!-- 

This Aspect adds a link to download an aggregated KML file in TAMU DSpace instance. 

-->
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">
	<map:components>
		
		<!-- testing putting this in at aspect in addition to global sitemap -->
		<!--
		<map:generators detault="file">
			<map:generator name="AggregateKMLGenerator" src="edu.tamu.dspace.aggregateKML.AggregateKMLGenerator"/>
		</map:generators>
		-->
		
		<map:transformers>
			<map:transformer name="AggregateKMLNavigation" src="edu.tamu.dspace.aggregateKML.AggregateKMLNavigation"/>
		</map:transformers>
	
		<map:matchers default="wildcard">
			<map:matcher name="HandleTypeMatcher" src="org.dspace.app.xmlui.aspect.general.HandleTypeMatcher"/>
		</map:matchers>

	</map:components>
	
	<map:pipelines>
		<map:pipeline>
			<map:generate/>
						
			<map:match type="HandleTypeMatcher" pattern="collection">
			
				<map:match pattern="handle/*/*">
				    <map:transform type="AggregateKMLNavigation"/>
				</map:match>
				
				<!-- testing putting this in at aspect in addition to global sitemap -->
				<!--
				<map:match pattern="metadata/handle/*/*/georeferences.kml">
					<map:generate type="AggregateKMLGenerator">
						<map:parameter name="handle" value="{1}/{2}"/>
					</map:generate>
				</map:match>
				-->
				
			</map:match>
			
			<!-- Not a URL we care about, so just pass it on. -->
			<map:serialize type="xml"/>
			
		</map:pipeline>
	</map:pipelines>
</map:sitemap>
